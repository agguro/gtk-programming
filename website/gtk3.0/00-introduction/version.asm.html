<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="Generator" content="Kate, the KDE Advanced Text Editor" />
<title>version.asm</title>
</head>
<!-- Highlighting: "Intel x86 (NASM)" -->
<body>
<pre style='color:#1f1c1b;background-color:#ffffff;'>
<span style='color:#898887;'>; Name        : version.asm</span>
<span style='color:#898887;'>;</span>
<span style='color:#898887;'>; Build       : aclocal &amp;&amp; autoconf &amp;&amp; automake --add-missing --foreign</span>
<span style='color:#898887;'>;               mkdir build</span>
<span style='color:#898887;'>;               cd build</span>
<span style='color:#898887;'>;               ../configure</span>
<span style='color:#898887;'>;               make</span>
<span style='color:#898887;'>;</span>
<span style='color:#898887;'>; Description : The program is restircted to show some data stored in the glib and gtk shared</span>
<span style='color:#898887;'>;               libraries.</span>
<span style='color:#898887;'>;               these strings can be obtained with </span>
<span style='color:#898887;'>;               objdump -t -T /usr/lib/x86_64-linux-gnu/libglib-2.0.so | grep .rodata</span>
<span style='color:#898887;'>;               objdump -t -T /usr/lib/x86_64-linux-gnu/libgtk-x11-2.0.so | grep .rodata</span>
<span style='color:#898887;'>;               and so on for other libraries.</span>
<span style='color:#898887;'>;</span>
<span style='color:#898887;'>; Source        : http://zetcode.com/gui/gtk2/introduction/</span>

<b>bits</b><span style='color:#b08000;'> 64</span>

[list -]
    <span style='color:#898887;'>;glib parameters</span>
    <b>extern</b>    glib_minor_version
    <b>extern</b>    glib_micro_version
    <b>extern</b>    glib_ma<b>jo</b>r_version
    <span style='color:#898887;'>;gtk routines</span>
    <b>extern</b>    gtk_get_ma<b>jo</b>r_version
    <b>extern</b>    gtk_get_minor_version
    <b>extern</b>    gtk_get_micro_version
    <span style='color:#898887;'>;stdio</span>
    <b>extern</b>    printf
    <b>extern</b>    exit
[list +]

<b>section</b> .rodata
<span style='color:#644a9b;'>    version:</span>    <span style='color:#0057ae;'>db</span>    <span style='color:#bf0303;'>&quot;Glib version: %d.%d.%d&quot;</span>,<span style='color:#b08000;'>10</span>
                <span style='color:#0057ae;'>db</span>    <span style='color:#bf0303;'>&quot;Gtk version: %d.%d.%d&quot;</span>,<span style='color:#b08000;'>10</span>,<span style='color:#b08000;'>0</span>

<b>section</b> .text
<b>global</b> _start

<span style='color:#644a9b;'>_start:</span>
    <b>call</b>    gtk_get_ma<b>jo</b>r_version
    <b>mov</b>     <b>r8</b>,<b>rax</b>
    <b>call</b>    gtk_get_minor_version
    <b>mov</b>     <b>r9</b>,<b>rax</b>
    <b>call</b>    gtk_get_micro_version
    <b>push</b>    <b>rax</b>
    <b>mov</b>     <b>rcx</b>,[glib_micro_version]    
    <b>mov</b>     <b>rdx</b>,[glib_minor_version]    
    <b>mov</b>     <b>rsi</b>,[glib_ma<b>jo</b>r_version]    
    <b>mov</b>     <b>rdi</b>,version
    <b>mov</b>     <b>rax</b>,<span style='color:#b08000;'>0</span>
    <b>call</b>    printf
<span style='color:#644a9b;'>.exit:</span>    
    <span style='color:#898887;'>;exit program</span>
    <b>xor</b>     <b>rdi</b>,<b>rdi</b>
    <b>call</b>    exit
</pre>
</body>
</html>
